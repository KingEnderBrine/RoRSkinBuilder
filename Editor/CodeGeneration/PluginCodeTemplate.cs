// ------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Runtime Version: 17.0.0.0
//  
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
// ------------------------------------------------------------------------------
namespace RoRSkinBuilder
{
    using System.Linq;
    using System.Text;
    using System.Collections.Generic;
    using RoRSkinBuilder.Data;
    using UnityEngine.Rendering;
    using System;
    
    /// <summary>
    /// Class to produce the template output
    /// </summary>
    [global::System.CodeDom.Compiler.GeneratedCodeAttribute("Microsoft.VisualStudio.TextTemplating", "17.0.0.0")]
    public partial class PluginCodeTemplate : PluginCodeTemplateBase
    {
        /// <summary>
        /// Create the template output
        /// </summary>
        public override string TransformText()
        {
            this.Write(@"using BepInEx;
using BepInEx.Logging;
using RoR2;
using System;
using System.Collections.Generic;
using System.Linq;
using UnityEngine;
using System.Security.Permissions;
using RoR2.ContentManagement;
using UnityEngine.AddressableAssets;
using System.Collections;
using UnityEngine.ResourceManagement.AsyncOperations;
using System.Runtime.CompilerServices;


#pragma warning disable CS0618 // Type or member is obsolete
[assembly: SecurityPermission(SecurityAction.RequestMinimum, SkipVerification = true)]
#pragma warning restore CS0618 // Type or member is obsolete
namespace ");
            this.Write(this.ToStringHelper.ToStringWithCulture(AssetsInfo.uccModName));
            this.Write("\r\n{\r\n");
 foreach (var dependency in DistinctDependencies) { 
            this.Write("    [BepInDependency(\"");
            this.Write(this.ToStringHelper.ToStringWithCulture(dependency.Key));
            this.Write("\", BepInDependency.DependencyFlags.");
            this.Write(this.ToStringHelper.ToStringWithCulture(Enum.GetName(typeof(DependencyType), dependency.Value)));
            this.Write(")]\r\n");
 } 
            this.Write("    \r\n    [BepInPlugin(GUID, Name, Version)]\r\n    public partial class ");
            this.Write(this.ToStringHelper.ToStringWithCulture(AssetsInfo.uccModName));
            this.Write("Plugin : BaseUnityPlugin\r\n    {\r\n        public const string GUID = \"com.");
            this.Write(this.ToStringHelper.ToStringWithCulture(SkinModInfo.author.StripSpaces()));
            this.Write(".");
            this.Write(this.ToStringHelper.ToStringWithCulture(AssetsInfo.uccModName));
            this.Write("\";\r\n        public const string Name = \"");
            this.Write(this.ToStringHelper.ToStringWithCulture(SkinModInfo.modName));
            this.Write("\";\r\n        public const string Version = \"");
            this.Write(this.ToStringHelper.ToStringWithCulture(SkinModInfo.version));
            this.Write("\";\r\n\r\n        internal static ");
            this.Write(this.ToStringHelper.ToStringWithCulture(AssetsInfo.uccModName));
            this.Write("Plugin Instance { get; private set; }\r\n        internal static ManualLogSource In" +
                    "stanceLogger => Instance?.Logger;\r\n        \r\n        private static AssetBundle " +
                    "assetBundle;\r\n");
 if (AssetsInfo.materialsWithRoRShader.Count > 0) { 
            this.Write("        private static readonly List<Material> materialsWithRoRShader = new List<" +
                    "Material>();\r\n");
 } 
 if (AssetsInfo.texturePaths.Count > 0) { 
            this.Write("        private static readonly Dictionary<string, Texture> preloadedTextures = n" +
                    "ew Dictionary<string, Texture>();\r\n");
 } 
 if (AssetsInfo.materialReplacements.Any(r => r.useAddressablesMaterial)) { 
            this.Write("        private static readonly Dictionary<string, Material> preloadedMaterials =" +
                    " new Dictionary<string, Material>();\r\n");
 } 
            this.Write(@"
        private void Start()
        {
            Instance = this;

            var assetBundlePath = System.IO.Path.Combine(System.IO.Path.GetDirectoryName(Info.Location), Content.bundleName);
            if (!System.IO.File.Exists(assetBundlePath))
            {
                Logger.LogError($""Couldn't find file \""{Content.bundleName}\"" next to \""{System.IO.Path.GetFileName(Info.Location)}\"""");
                return;
            }

            Language.collectLanguageRootFolders += CollectLanguageRootFolders;
            ContentManager.collectContentPackProviders += Content.CollectProvider;

            AfterStart();
        }
        
        public void CollectLanguageRootFolders(List<string> folders)
        {
            folders.Add(System.IO.Path.Combine(System.IO.Path.GetDirectoryName(Info.Location), ""Language""));
        }

        partial void AfterStart();
");
 foreach (var skin in ReorderedSkins) { 
            this.Write("        static partial void ");
            this.Write(this.ToStringHelper.ToStringWithCulture(skin.bodyName.ToUpperCamelCase()));
            this.Write(this.ToStringHelper.ToStringWithCulture(skin.name.ToUpperCamelCase()));
            this.Write("SkinAdded(SkinDef skinDef, GameObject bodyPrefab);\r\n");
 } 
            this.Write("\r\n        public partial class Content : IContentPackProvider\r\n        {\r\n       " +
                    "     public const string bundleName = \"");
            this.Write(this.ToStringHelper.ToStringWithCulture(AssetsInfo.assetBundleName));
            this.Write(@""";

            public string identifier => GUID;

            private Content() { }

            internal static void CollectProvider(ContentManager.AddContentPackProviderDelegate addContentPackProvider)
            {
                addContentPackProvider(new Content());
            }
");
 { 
      var startProgress = 0F; var endProgress = 0.25F; 
            this.Write(@"            public IEnumerator LoadStaticContentAsync(LoadStaticContentAsyncArgs args)
            {
                var assetBundleRequest = AssetBundle.LoadFromFileAsync(System.IO.Path.Combine(System.IO.Path.GetDirectoryName(Instance.Info.Location), bundleName));
                yield return HandleAsyncOperationProgress(args, assetBundleRequest, ");
            this.Write(this.ToStringHelper.ToStringWithCulture(startProgress.ToFloatString()));
            this.Write(", ");
            this.Write(this.ToStringHelper.ToStringWithCulture(endProgress.ToFloatString()));
            this.Write(");\r\n                assetBundle = assetBundleRequest.assetBundle;\r\n\r\n");
      if (AssetsInfo.materialsWithRoRShader.Count != 0) { 
          startProgress = endProgress; endProgress = 0.3F; 
            this.Write("                yield return ReplaceShaders(args, ");
            this.Write(this.ToStringHelper.ToStringWithCulture(startProgress.ToFloatString()));
            this.Write(", ");
            this.Write(this.ToStringHelper.ToStringWithCulture(endProgress.ToFloatString()));
            this.Write(");\r\n");
      } 
            this.Write("\r\n");
      if (AssetsInfo.texturePaths.Count > 0) { 
          startProgress = endProgress; endProgress = 0.35F; 
            this.Write("                yield return PreloadTextures(args, ");
            this.Write(this.ToStringHelper.ToStringWithCulture(startProgress.ToFloatString()));
            this.Write(", ");
            this.Write(this.ToStringHelper.ToStringWithCulture(endProgress.ToFloatString()));
            this.Write(");\r\n");
 } 
 if (AssetsInfo.materialReplacements.Any(r => r.useAddressablesMaterial)) { 
          startProgress = endProgress; endProgress = 0.4F; 
            this.Write("                yield return PreloadMaterials(args, ");
            this.Write(this.ToStringHelper.ToStringWithCulture(startProgress.ToFloatString()));
            this.Write(", ");
            this.Write(this.ToStringHelper.ToStringWithCulture(endProgress.ToFloatString()));
            this.Write(");\r\n");
 } 
            this.Write("\r\n");
      var endProgressStep = (1F - endProgress) / ReorderedSkins.Count; 
      foreach (var skin in ReorderedSkins) { 
          startProgress = endProgress; endProgress += endProgressStep; 
            this.Write("                yield return Prepare");
            this.Write(this.ToStringHelper.ToStringWithCulture(skin.bodyName.ToUpperCamelCase()));
            this.Write(this.ToStringHelper.ToStringWithCulture(skin.name.ToUpperCamelCase()));
            this.Write("Skin(args, ");
            this.Write(this.ToStringHelper.ToStringWithCulture(startProgress.ToFloatString()));
            this.Write(", ");
            this.Write(this.ToStringHelper.ToStringWithCulture(endProgress.ToFloatString()));
            this.Write(");\r\n");
      } 
            this.Write("\r\n                args.ReportProgress(1F);\r\n            }\r\n");
 } 
            this.Write("\r\n            public IEnumerator GenerateContentPackAsync(GetContentPackAsyncArgs" +
                    " args)\r\n            {\r\n");
 foreach (var skin in ReorderedSkins) { 
            this.Write("                Fill");
            this.Write(this.ToStringHelper.ToStringWithCulture(skin.bodyName.ToUpperCamelCase()));
            this.Write(this.ToStringHelper.ToStringWithCulture(skin.name.ToUpperCamelCase()));
            this.Write("Skin(args);\r\n");
 } 
            this.Write("\r\n                args.ReportProgress(1);\r\n                yield break;\r\n        " +
                    "    }\r\n\r\n            public IEnumerator FinalizeAsync(FinalizeAsyncArgs args)\r\n " +
                    "           {\r\n");
 if (AssetsInfo.materialsWithRoRShader.Count > 0) { 
            this.Write("                materialsWithRoRShader.Clear();\r\n");
 } 
 if (AssetsInfo.texturePaths.Count > 0) { 
            this.Write("                preloadedTextures.Clear();\r\n");
 } 
 if (AssetsInfo.materialReplacements.Any(r => r.useAddressablesMaterial)) { 
            this.Write("\t\t\t    preloadedMaterials.Clear();\r\n");
 } 
            this.Write("                args.ReportProgress(1F);\r\n                yield break;\r\n         " +
                    "   }\r\n");
 if (AssetsInfo.materialsWithRoRShader.Count != 0) { 
      { 
          var startProgress = 0F; var endProgress = 0F; var endProgressStep = 1F / AssetsInfo.materialsWithRoRShader.Count; 
            this.Write("\r\n            private static IEnumerator ReplaceShaders(LoadStaticContentAsyncArg" +
                    "s args, float startProgress, float endProgress)\r\n            {\r\n                " +
                    "var totalProgress = endProgress - startProgress;\r\n\r\n");
          foreach (var row in AssetsInfo.materialsWithRoRShader) { 
              startProgress = endProgress; endProgress += endProgressStep; 
            this.Write("                yield return LoadMaterialsWithReplacedShader(args, startProgress " +
                    "+ totalProgress * 0, startProgress + totalProgress * 1\r\n                    , @\"" +
                    "");
            this.Write(this.ToStringHelper.ToStringWithCulture(row.Key));
            this.Write("\"\r\n");
              foreach (var material in row.Value) { 
            this.Write("                    , @\"");
            this.Write(this.ToStringHelper.ToStringWithCulture(AssetsInfo.materialPaths[material]));
            this.Write("\"");
 } 
            this.Write(");\r\n");
          } 
            this.Write("                \r\n            }\r\n");
      } 
            this.Write(@"
            private static IEnumerator LoadMaterialsWithReplacedShader(LoadStaticContentAsyncArgs args, float startProgress, float endProgress, string shaderPath, params string[] materialPaths)
            {
                var operations = new IAsyncOperationWrapper[materialPaths.Length + 1];
                operations[0] = LoadAddressablesAssetAsync<Shader>(shaderPath);

                for (var i = 0; i < materialPaths.Length; i++)
                {
                    operations[i + 1] = LoadAssetAsync<Material>(assetBundle, materialPaths[i]);
                }

                yield return HandleAsyncOperationsProgress(args, startProgress, endProgress, operations);

                var shader = operations[0].Asset as Shader;

                for (var i = 1; i < operations.Length; i++)
                {
                    var material = operations[i].Asset as Material;
                    material.shader = shader;
                    materialsWithRoRShader.Add(material);
                }
            }
");
 } 
      if (AssetsInfo.texturePaths.Count > 0) { 
            this.Write("\r\n            private static IEnumerator PreloadTextures(LoadStaticContentAsyncAr" +
                    "gs args, float startProgress, float endProgress)\r\n            {\r\n               " +
                    " var operations = new IAsyncOperationWrapper[]\r\n                {\r\n");
          foreach (var path in AssetsInfo.texturePaths.Values) { 
            this.Write("                    LoadAssetAsync<Texture>(assetBundle, @\"");
            this.Write(this.ToStringHelper.ToStringWithCulture(path.UnityPath()));
            this.Write("\"),\r\n");
          } 
            this.Write("                };\r\n\r\n                yield return HandleAsyncOperationsProgress(" +
                    "args, startProgress, endProgress, operations);\r\n\r\n");
          foreach (var (path, i) in AssetsInfo.texturePaths.Values.GetIndexedEnumerable()) { 
            this.Write("                preloadedTextures[\"");
            this.Write(this.ToStringHelper.ToStringWithCulture(path.UnityPath()));
            this.Write("\"] = operations[");
            this.Write(this.ToStringHelper.ToStringWithCulture(i));
            this.Write("].Asset as Texture;\r\n");
          } 
            this.Write("            }\r\n");
 } 
 if (AssetsInfo.materialReplacements.Any(r => r.useAddressablesMaterial)) { 
            this.Write("\r\n            private static IEnumerator PreloadMaterials(LoadStaticContentAsyncA" +
                    "rgs args, float startProgress, float endProgress)\r\n            {\r\n              " +
                    "  var operations = new IAsyncOperationWrapper[]\r\n                {\r\n");
          foreach (var replacement in AssetsInfo.materialReplacements.Where(r => r.useAddressablesMaterial)) { 
            this.Write("                    LoadAssetAsync<Texture>(assetBundle, @\"");
            this.Write(this.ToStringHelper.ToStringWithCulture(replacement.addressablesKey));
            this.Write("\"),\r\n");
          } 
            this.Write("                };\r\n\r\n                yield return HandleAsyncOperationsProgress(" +
                    "args, startProgress, endProgress, operations);\r\n\r\n");
          foreach (var (replacement, i) in AssetsInfo.materialReplacements.Where(r => r.useAddressablesMaterial).GetIndexedEnumerable()) { 
            this.Write("                preloadedMaterials[\"");
            this.Write(this.ToStringHelper.ToStringWithCulture(replacement.addressablesKey));
            this.Write("\"] = operations[");
            this.Write(this.ToStringHelper.ToStringWithCulture(i));
            this.Write("].Asset as Material;\r\n");
          } 
            this.Write("            }\r\n");
 } 
            this.Write("\r\n");
 foreach (var skin in ReorderedSkins) { 
            this.Write("            static partial void Prepare");
            this.Write(this.ToStringHelper.ToStringWithCulture(skin.bodyName.ToUpperCamelCase()));
            this.Write(this.ToStringHelper.ToStringWithCulture(skin.name.ToUpperCamelCase()));
            this.Write("SkinLoadingAssets(ref IAsyncOperationWrapper[] operations);\r\n            static p" +
                    "artial void Prepare");
            this.Write(this.ToStringHelper.ToStringWithCulture(skin.bodyName.ToUpperCamelCase()));
            this.Write(this.ToStringHelper.ToStringWithCulture(skin.name.ToUpperCamelCase()));
            this.Write("SkinDone(ref IAsyncOperationWrapper[] operations);\r\n            private static bo" +
                    "ol ");
            this.Write(this.ToStringHelper.ToStringWithCulture(skin.bodyName.ToUpperCamelCase()));
            this.Write(this.ToStringHelper.ToStringWithCulture(skin.name.ToUpperCamelCase()));
            this.Write("StopAdding { get; set; }\r\n            public static SkinDef ");
            this.Write(this.ToStringHelper.ToStringWithCulture(skin.bodyName.ToUpperCamelCase()));
            this.Write(this.ToStringHelper.ToStringWithCulture(skin.name.ToUpperCamelCase()));
            this.Write("SkinDef { get; set; }\r\n\r\n");
      { 
            this.Write("            private static IEnumerator Prepare");
            this.Write(this.ToStringHelper.ToStringWithCulture(skin.bodyName.ToUpperCamelCase()));
            this.Write(this.ToStringHelper.ToStringWithCulture(skin.name.ToUpperCamelCase()));
            this.Write("Skin(LoadStaticContentAsyncArgs args, float startProgress, float endProgress)\r\n  " +
                    "          {\r\n");
          if (!string.IsNullOrWhiteSpace(skin.modDependency.value) && skin.modDependency.type == DependencyType.SoftDependency) { 
            this.Write("                if (!BepInEx.Bootstrap.Chainloader.PluginInfos.ContainsKey(\"");
            this.Write(this.ToStringHelper.ToStringWithCulture(skin.modDependency.value));
            this.Write("\"))\r\n                {\r\n                    ");
            this.Write(this.ToStringHelper.ToStringWithCulture(skin.bodyName.ToUpperCamelCase()));
            this.Write(this.ToStringHelper.ToStringWithCulture(skin.name.ToUpperCamelCase()));
            this.Write("StopAdding = true;\r\n                    yield break;\r\n                }\r\n\r\n");
          } 
          if (skin.config.generateEnableConfig) { 
            this.Write("                if (!Instance.Config.Bind(\"");
            this.Write(this.ToStringHelper.ToStringWithCulture(skin.name.ToUpperCamelCase()));
            this.Write("\", \"Enabled\", ");
            this.Write(this.ToStringHelper.ToStringWithCulture(skin.config.enableConfigDefaultValue.ToLiteral()));
            this.Write(").Value)\r\n                {\r\n                    ");
            this.Write(this.ToStringHelper.ToStringWithCulture(skin.bodyName.ToUpperCamelCase()));
            this.Write(this.ToStringHelper.ToStringWithCulture(skin.name.ToUpperCamelCase()));
            this.Write("StopAdding = true;\r\n                    yield break;\r\n                }\r\n\r\n");
          } 
          var operationIndexByObject = new Dictionary<object, int>();
            var nextOperationIndex = 1; 
            this.Write("                var operations = new IAsyncOperationWrapper[]\r\n                {\r" +
                    "\n                    LoadAssetAsync<SkinDef>(assetBundle, \"");
            this.Write(this.ToStringHelper.ToStringWithCulture(AssetsInfo.skinDefPaths[skin].UnityPath()));
            this.Write("\"),\r\n");
          foreach (var (rendererInfo, i) in skin.rendererInfos.GetIndexedEnumerable()) { 
              if (!rendererInfo.useMaterialReplacement && rendererInfo.defaultMaterial != null && !operationIndexByObject.ContainsKey(rendererInfo.defaultMaterial)) { 
            this.Write("                    LoadAssetAsync<Material>(assetBundle, @\"");
            this.Write(this.ToStringHelper.ToStringWithCulture(AssetsInfo.materialPaths[rendererInfo.defaultMaterial].UnityPath()));
            this.Write("\"),\r\n");
 operationIndexByObject[rendererInfo.defaultMaterial] = nextOperationIndex++; 
              } 
          } 
          foreach (var (replacement, i) in skin.meshReplacements.GetIndexedEnumerable()) { 
              if (replacement.mesh != null && !operationIndexByObject.ContainsKey(replacement.mesh)) { 
            this.Write("                    LoadAssetAsync<Mesh>(assetBundle, @\"");
            this.Write(this.ToStringHelper.ToStringWithCulture(AssetsInfo.meshPaths[replacement.mesh].UnityPath()));
            this.Write("\"),\r\n");
 operationIndexByObject[replacement.mesh] = nextOperationIndex++;
              } 
          } 
          foreach (var (replacement, i) in skin.projectileGhostReplacements.GetIndexedEnumerable()) { 
              if (!operationIndexByObject.ContainsKey(replacement.projectilePath)) { 
            this.Write("                    LoadAddressablesAssetAsync<GameObject>(@\"");
            this.Write(this.ToStringHelper.ToStringWithCulture(replacement.projectilePath));
            this.Write("\"),\r\n");
 operationIndexByObject[replacement.projectilePath] = nextOperationIndex++; 
              } 
              if (replacement.useResourcesPath) { 
                  if (!operationIndexByObject.ContainsKey(replacement.projectileGhostPath)) { 
            this.Write("                    LoadAddressablesAssetAsync<GameObject>(@\"");
            this.Write(this.ToStringHelper.ToStringWithCulture(replacement.projectileGhostPath));
            this.Write("\"),\r\n");
                      operationIndexByObject[replacement.projectileGhostPath] = nextOperationIndex++; 
                  } 
              } else { 
                  if (!operationIndexByObject.ContainsKey(replacement.projectileGhost)) { 
            this.Write("                    LoadAssetAsync<GameObject>(assetBundle, @\"");
            this.Write(this.ToStringHelper.ToStringWithCulture(AssetsInfo.gameObjectPaths[replacement.projectileGhost].UnityPath()));
            this.Write("\"),\r\n");
                      operationIndexByObject[replacement.projectileGhost] = nextOperationIndex++; 
                  } 
              } 
          } 
            this.Write("                };\r\n\r\n                var extraOperation = Array.Empty<IAsyncOper" +
                    "ationWrapper>();\r\n                Prepare");
            this.Write(this.ToStringHelper.ToStringWithCulture(skin.bodyName.ToUpperCamelCase()));
            this.Write(this.ToStringHelper.ToStringWithCulture(skin.name.ToUpperCamelCase()));
            this.Write("SkinLoadingAssets(ref extraOperation);\r\n\r\n                yield return HandleAsyn" +
                    "cOperationsProgress(args, startProgress, endProgress, operations.Union(extraOper" +
                    "ation).ToArray());\r\n\r\n                var skin = ");
            this.Write(this.ToStringHelper.ToStringWithCulture(skin.bodyName.ToUpperCamelCase()));
            this.Write(this.ToStringHelper.ToStringWithCulture(skin.name.ToUpperCamelCase()));
            this.Write("SkinDef = operations[0].Asset as SkinDef;\r\n                skin.runtimeSkin = nul" +
                    "l;\r\n\r\n");
          if (skin.rendererInfos.Count > 0) { 
            this.Write("                skin.rendererInfos = new CharacterModel.RendererInfo[]\r\n         " +
                    "       {\r\n");
              foreach (var (rendererInfo, i) in skin.rendererInfos.GetIndexedEnumerable()) { 
            this.Write("                    new CharacterModel.RendererInfo\r\n                    {\r\n");
                  if (rendererInfo.useMaterialReplacement || rendererInfo.defaultMaterial == null) { 
            this.Write("                        defaultMaterial = null,\r\n");
                  } else { 
            this.Write("                        defaultMaterial = operations[");
            this.Write(this.ToStringHelper.ToStringWithCulture(operationIndexByObject[rendererInfo.defaultMaterial]));
            this.Write("].Asset as Material,\r\n");
                  } 
            this.Write("                        defaultShadowCastingMode = UnityEngine.Rendering.ShadowCa" +
                    "stingMode.");
            this.Write(this.ToStringHelper.ToStringWithCulture(Enum.GetName(typeof(ShadowCastingMode), rendererInfo.defaultShadowCastingMode)));
            this.Write(",\r\n                        ignoreOverlays = ");
            this.Write(this.ToStringHelper.ToStringWithCulture(rendererInfo.ignoreOverlays.ToLiteral()));
            this.Write(",\r\n                    },\r\n");
              } 
            this.Write("                };\r\n");
          } 
          if (skin.meshReplacements.Count > 0) { 
            this.Write("                skin.meshReplacements = new SkinDef.MeshReplacement[]\r\n          " +
                    "      {\r\n");
              foreach (var (replacement, i) in skin.meshReplacements.GetIndexedEnumerable()) { 
            this.Write("                    new SkinDef.MeshReplacement\r\n                    {\r\n");
                  if (replacement.mesh == null) { 
            this.Write("                        mesh = null,\r\n");
                  } else { 
            this.Write("                        mesh = operations[");
            this.Write(this.ToStringHelper.ToStringWithCulture(operationIndexByObject[replacement.mesh]));
            this.Write("].Asset as Mesh,\r\n");
                  } 
            this.Write("                    },\r\n");
              } 
            this.Write("                };\r\n");
          } 
          if (skin.projectileGhostReplacements.Count > 0) { 
            this.Write("                skin.projectileGhostReplacements = new SkinDef.ProjectileGhostRep" +
                    "lacement[]\r\n                {\r\n");
              foreach (var replacement in skin.projectileGhostReplacements) { 
            this.Write("                    new SkinDef.ProjectileGhostReplacement\r\n                    {" +
                    "\r\n                        projectilePrefab = operations[");
            this.Write(this.ToStringHelper.ToStringWithCulture(operationIndexByObject[replacement.projectilePath]));
            this.Write("].Asset as GameObject,\r\n");
                  if (replacement.useResourcesPath) { 
            this.Write("                        projectileGhostReplacementPrefab = operations[");
            this.Write(this.ToStringHelper.ToStringWithCulture(operationIndexByObject[replacement.projectileGhostPath]));
            this.Write("].Asset as GameObject\r\n");
                  } else { 
            this.Write("                        projectileGhostReplacementPrefab = operations[");
            this.Write(this.ToStringHelper.ToStringWithCulture(operationIndexByObject[replacement.projectileGhost]));
            this.Write("].Asset as GameObject\r\n");
                  } 
            this.Write("                    },\r\n");
              } 
            this.Write("                };\r\n");
          } 
            this.Write("\r\n                Prepare");
            this.Write(this.ToStringHelper.ToStringWithCulture(skin.bodyName.ToUpperCamelCase()));
            this.Write(this.ToStringHelper.ToStringWithCulture(skin.name.ToUpperCamelCase()));
            this.Write("SkinDone(ref extraOperation);\r\n            }\r\n");
      } 
            this.Write("\r\n            private static void Fill");
            this.Write(this.ToStringHelper.ToStringWithCulture(skin.bodyName.ToUpperCamelCase()));
            this.Write(this.ToStringHelper.ToStringWithCulture(skin.name.ToUpperCamelCase()));
            this.Write("Skin(GetContentPackAsyncArgs args)\r\n            {\r\n                if (");
            this.Write(this.ToStringHelper.ToStringWithCulture(skin.bodyName.ToUpperCamelCase()));
            this.Write(this.ToStringHelper.ToStringWithCulture(skin.name.ToUpperCamelCase()));
            this.Write("StopAdding)\r\n                {\r\n                    return;\r\n                }\r\n\r" +
                    "\n                var skin = ");
            this.Write(this.ToStringHelper.ToStringWithCulture(skin.bodyName.ToUpperCamelCase()));
            this.Write(this.ToStringHelper.ToStringWithCulture(skin.name.ToUpperCamelCase()));
            this.Write("SkinDef;\r\n                var bodyName = \"");
            this.Write(this.ToStringHelper.ToStringWithCulture(skin.bodyName));
            this.Write(@""";
                var skinName = skin.name;
                try
                {
                    var bodyPrefab = args.peerLoadInfos.SelectMany(i => i.previousContentPack.bodyPrefabs).FirstOrDefault(p => p.name == bodyName);
                    if (!bodyPrefab)
                    {
                        return;
                    }

                    var modelLocator = bodyPrefab.GetComponent<ModelLocator>();
                    if (!modelLocator)
                    {
                        InstanceLogger.LogWarning($""Failed to add \""{skinName}\"" skin to \""{bodyName}\"" because it doesn't have \""ModelLocator\"" component"");
                        ");
            this.Write(this.ToStringHelper.ToStringWithCulture(skin.bodyName.ToUpperCamelCase()));
            this.Write(this.ToStringHelper.ToStringWithCulture(skin.name.ToUpperCamelCase()));
            this.Write(@"StopAdding = true;
                        return;
                    }

                    var mdl = modelLocator.modelTransform.gameObject;
                    var skinController = mdl ? mdl.GetComponent<ModelSkinController>() : null;
                    if (!skinController)
                    {
                        InstanceLogger.LogWarning($""Failed to add \""{skinName}\"" skin to \""{bodyName}\"" because it doesn't have \""ModelSkinController\"" component"");
                        ");
            this.Write(this.ToStringHelper.ToStringWithCulture(skin.bodyName.ToUpperCamelCase()));
            this.Write(this.ToStringHelper.ToStringWithCulture(skin.name.ToUpperCamelCase()));
            this.Write("StopAdding = true;\r\n                        return;\r\n                    }\r\n\r\n");
      switch (skin.renderersSource)
        {
            case RenderersSource.AllRendererComponents: 
            this.Write("                    var renderers = mdl.GetComponentsInChildren<Renderer>(true);\r" +
                    "\n");
              break;
            case RenderersSource.BaseRendererInfos: 
            this.Write(@"                    var characterModel = mdl.GetComponent<CharacterModel>();
                    if (!characterModel)
                    {
                        InstanceLogger.LogWarning($""Failed to add \""{skinName}\"" skin to \""{bodyName}\"" because it doesn't have \""CharacterModel\"" component"");
                        return;
                    }
                    var renderers = characterModel.baseRendererInfos.Select(info => info.renderer).ToArray();
");
              break;
        } 
            this.Write("\r\n                    skin.rootObject = mdl;\r\n");
      if (skin.baseSkins.Count > 0) { 
            this.Write("                    TryCatchThrow(\"Base Skins\", () =>\r\n                    {\r\n   " +
                    "                     skin.baseSkins = new SkinDef[] \r\n                        { " +
                    "\r\n");
          foreach (var reference in skin.baseSkins) { 
                if (reference.accessType == AccessType.ByIndex) { 
            this.Write("                            skinController.skins[");
            this.Write(this.ToStringHelper.ToStringWithCulture(reference.index));
            this.Write("],\r\n");
              } else { 
            this.Write("                            skinController.skins.First(s => s.Name == \"");
            this.Write(this.ToStringHelper.ToStringWithCulture(reference.name));
            this.Write("\")\r\n");
              } 
            } 
            this.Write("                        };\r\n                    });\r\n");
      } 
      if (!string.IsNullOrWhiteSpace(skin.unlockableName)) { 
            this.Write("                    TryCatchThrow(\"Unlockable Name\", () =>\r\n                    {" +
                    "\r\n                        skin.unlockableDef = args.peerLoadInfos.SelectMany(i =" +
                    "> i.previousContentPack.unlockableDefs).First(def => def.cachedName == \"");
            this.Write(this.ToStringHelper.ToStringWithCulture(skin.unlockableName));
            this.Write("\");\r\n                    });\r\n");
      } 
            this.Write("                    TryCatchThrow(\"Game Object Activations\", () =>\r\n             " +
                    "       {\r\n");
      if (skin.gameObjectActivations.Count >= 0) { 
            this.Write("                        skin.gameObjectActivations = new SkinDef.GameObjectActiva" +
                    "tion[]\r\n                        {\r\n");
          foreach (var activation in skin.gameObjectActivations) { 
            this.Write("                            new SkinDef.GameObjectActivation\r\n                   " +
                    "         {\r\n");
 if (activation.accessType == GameObjectActivationAccessType.ByRendererIndex) { 
            this.Write("                                gameObject = renderers[");
            this.Write(this.ToStringHelper.ToStringWithCulture(activation.rendererIndex));
            this.Write("].gameObject,\r\n");
 } else if (activation.accessType == GameObjectActivationAccessType.ByRendererName) { 
            this.Write("                                gameObject = renderers.First(r => r.name == \"");
            this.Write(this.ToStringHelper.ToStringWithCulture(activation.rendererName));
            this.Write("\").gameObject,\r\n");
 } else if (activation.accessType == GameObjectActivationAccessType.ByPath) { 
            this.Write("                                gameObject = mdl.transform.Find(\"");
            this.Write(this.ToStringHelper.ToStringWithCulture(activation.path));
            this.Write("\").gameObject,\r\n");
 } 
            this.Write("                                shouldActivate = ");
            this.Write(this.ToStringHelper.ToStringWithCulture(activation.shouldActivate.ToLiteral()));
            this.Write("\r\n                            },\r\n");
          } 
            this.Write("                        };\r\n                    });\r\n");
      } 
      if (skin.rendererInfos.Count > 0) { 
            this.Write("                    TryCatchThrow(\"Renderer Infos\", () =>\r\n                    {\r" +
                    "\n");
          foreach (var (rendererInfo, i) in skin.rendererInfos.GetIndexedEnumerable()) { 
              if (rendererInfo.useMaterialReplacement && rendererInfo.materialReplacement) { 
                  var replacement = rendererInfo.materialReplacement; 
                  if (replacement.useAddressablesMaterial) { 
            this.Write("                        skin.rendererInfos[");
            this.Write(this.ToStringHelper.ToStringWithCulture(i));
            this.Write("].defaultMaterial = Create");
            this.Write(this.ToStringHelper.ToStringWithCulture(replacement.name.ToUpperCamelCase()));
            this.Write("MaterialReplacement(preloadedMaterials[\"");
            this.Write(this.ToStringHelper.ToStringWithCulture(replacement.addressablesKey));
            this.Write("\"]);\r\n");
                  } else { 
                      if (replacement.rendererReference.accessType == AccessType.ByIndex) { 
            this.Write("                        skin.rendererInfos[");
            this.Write(this.ToStringHelper.ToStringWithCulture(i));
            this.Write("].defaultMaterial = Create");
            this.Write(this.ToStringHelper.ToStringWithCulture(replacement.name.ToUpperCamelCase()));
            this.Write("MaterialReplacement(renderers[");
            this.Write(this.ToStringHelper.ToStringWithCulture(replacement.rendererReference.index));
            this.Write("].material);\r\n");
                      } else { 
            this.Write("                        skin.rendererInfos[");
            this.Write(this.ToStringHelper.ToStringWithCulture(i));
            this.Write("].defaultMaterial = Create");
            this.Write(this.ToStringHelper.ToStringWithCulture(replacement.name.ToUpperCamelCase()));
            this.Write("MaterialReplacement(renderers.First(r => r.name == \"");
            this.Write(this.ToStringHelper.ToStringWithCulture(replacement.rendererReference.name));
            this.Write("\").material);\r\n");
                      } 
                  } 
              } 
              if (rendererInfo.rendererReference.accessType == AccessType.ByIndex) { 
            this.Write("                        skin.rendererInfos[");
            this.Write(this.ToStringHelper.ToStringWithCulture(i));
            this.Write("].renderer = renderers[");
            this.Write(this.ToStringHelper.ToStringWithCulture(rendererInfo.rendererReference.index));
            this.Write("];\r\n");
              } else { 
            this.Write("                        skin.rendererInfos[");
            this.Write(this.ToStringHelper.ToStringWithCulture(i));
            this.Write("].renderer = renderers.First(r => r.name == \"");
            this.Write(this.ToStringHelper.ToStringWithCulture(rendererInfo.rendererReference.name));
            this.Write("\");\r\n");
              } 
          }
            this.Write("                    });\r\n");
      } 
      if (skin.meshReplacements.Count > 0) { 
            this.Write("                    TryCatchThrow(\"Mesh Replacements\", () =>\r\n                   " +
                    " {\r\n");
          foreach (var (replacement, i) in skin.meshReplacements.GetIndexedEnumerable()) { 
              if (replacement.rendererReference.accessType == AccessType.ByIndex) { 
            this.Write("                        skin.meshReplacements[");
            this.Write(this.ToStringHelper.ToStringWithCulture(i));
            this.Write("].renderer = renderers[");
            this.Write(this.ToStringHelper.ToStringWithCulture(replacement.rendererReference.index));
            this.Write("];\r\n");
              } else { 
            this.Write("                        skin.meshReplacements[");
            this.Write(this.ToStringHelper.ToStringWithCulture(i));
            this.Write("].renderer = renderers.First(r => r.name == \"");
            this.Write(this.ToStringHelper.ToStringWithCulture(replacement.rendererReference.name));
            this.Write("\");\r\n");
              } 
          } 
            this.Write("                    });\r\n");
      } 
      if (skin.minionSkinReplacements.Count >= 0) { 
            this.Write("                    TryCatchThrow(\"Minion Skin Replacements\", () =>\r\n            " +
                    "        {\r\n");
          foreach (var bodyName in skin.minionSkinReplacements.Select(r => r.bodyName).Distinct()) { 
            this.Write("                        var ");
            this.Write(this.ToStringHelper.ToStringWithCulture(bodyName.ToLowerCamelCase()));
            this.Write("Prefab = args.peerLoadInfos.SelectMany(i => i.previousContentPack.bodyPrefabs).Fi" +
                    "rstOrDefault(p => p.name == \"");
            this.Write(this.ToStringHelper.ToStringWithCulture(bodyName));
            this.Write("\");\r\n");
          } 
            this.Write("                        skin.minionSkinReplacements = new SkinDef.MinionSkinRepla" +
                    "cement[]\r\n                        {\r\n");
          foreach (var replacement in skin.minionSkinReplacements) {
                if (!replacement.findSkinByReference && replacement.skin == null) {
                    continue;
                } 
            this.Write("                            new SkinDef.MinionSkinReplacement\r\n                  " +
                    "          {\r\n                                minionBodyPrefab = ");
            this.Write(this.ToStringHelper.ToStringWithCulture(replacement.bodyName.ToLowerCamelCase()));
            this.Write("Prefab,\r\n");
              if (replacement.findSkinByReference) { 
                    if (replacement.reference.accessType == AccessType.ByIndex) { 
            this.Write("                                minionSkin = ");
            this.Write(this.ToStringHelper.ToStringWithCulture(replacement.bodyName.ToLowerCamelCase()));
            this.Write("Prefab.GetComponent<ModelLocator>().modelTransform.GetComponent<ModelSkinControll" +
                    "er>().skins[");
            this.Write(this.ToStringHelper.ToStringWithCulture(replacement.reference.index));
            this.Write("]\r\n");
                  } else { 
            this.Write("                                minionSkin = ");
            this.Write(this.ToStringHelper.ToStringWithCulture(replacement.bodyName.ToLowerCamelCase()));
            this.Write("Prefab.GetComponent<ModelLocator>().modelTransform.GetComponent<ModelSkinControll" +
                    "er>().skins.First(s => s.name == @\"");
            this.Write(this.ToStringHelper.ToStringWithCulture(replacement.reference.name));
            this.Write("\")\r\n");
                  }
                } else { 
            this.Write("                                minionSkin = ");
            this.Write(this.ToStringHelper.ToStringWithCulture(replacement.skin.bodyName.ToUpperCamelCase()));
            this.Write(this.ToStringHelper.ToStringWithCulture(replacement.skin.name.ToUpperCamelCase()));
            this.Write("SkinDef\r\n");
              } 
            this.Write("                            },\r\n");
          } 
            this.Write("                        };\r\n                    });\r\n");
      } 
            this.Write("\r\n                    Array.Resize(ref skinController.skins, skinController.skins" +
                    ".Length + 1);\r\n                    skinController.skins[skinController.skins.Len" +
                    "gth - 1] = skin;\r\n\r\n                    ");
            this.Write(this.ToStringHelper.ToStringWithCulture(skin.bodyName.ToUpperCamelCase()));
            this.Write(this.ToStringHelper.ToStringWithCulture(skin.name.ToUpperCamelCase()));
            this.Write("StopAdding = true;\r\n\r\n                    ");
            this.Write(this.ToStringHelper.ToStringWithCulture(skin.bodyName.ToUpperCamelCase()));
            this.Write(this.ToStringHelper.ToStringWithCulture(skin.name.ToUpperCamelCase()));
            this.Write(@"SkinAdded(skin, bodyPrefab);
                    skin.Bake();
                }
                catch (FieldException e)
                {
                    InstanceLogger.LogWarning($""Failed to add \""{skinName}\"" skin to \""{bodyName}\"""");
                    InstanceLogger.LogWarning($""Field causing issue: {e.Message}"");
                    InstanceLogger.LogError(e.InnerException);
                    ");
            this.Write(this.ToStringHelper.ToStringWithCulture(skin.bodyName.ToUpperCamelCase()));
            this.Write(this.ToStringHelper.ToStringWithCulture(skin.name.ToUpperCamelCase()));
            this.Write(@"StopAdding = true;
                }
                catch (Exception e)
                {
                    InstanceLogger.LogWarning($""Failed to add \""{skinName}\"" skin to \""{bodyName}\"""");
                    InstanceLogger.LogError(e);
                    ");
            this.Write(this.ToStringHelper.ToStringWithCulture(skin.bodyName.ToUpperCamelCase()));
            this.Write(this.ToStringHelper.ToStringWithCulture(skin.name.ToUpperCamelCase()));
            this.Write("StopAdding = true;\r\n                }\r\n            }\r\n");
 } 
 foreach (var replacement in AssetsInfo.materialReplacements) { 
            this.Write("            private static Material Create");
            this.Write(this.ToStringHelper.ToStringWithCulture(replacement.name.ToUpperCamelCase()));
            this.Write("MaterialReplacement(Material source)\r\n            {\r\n                var replacem" +
                    "ent = Instantiate(source);\r\n\r\n");
      foreach (var field in replacement.fields) {
            switch (field.propertyType) {
                case ShaderField.PropertyType.Texture: { 
                    if (field.textureValue) { 
            this.Write("                replacement.SetTexture(\"");
            this.Write(this.ToStringHelper.ToStringWithCulture(field.propertyName));
            this.Write("\", preloadedTextures[\"");
            this.Write(this.ToStringHelper.ToStringWithCulture(AssetsInfo.texturePaths[field.textureValue].UnityPath()));
            this.Write("\"]);\r\n");
                  } else { 
            this.Write("                replacement.SetTexture(\"");
            this.Write(this.ToStringHelper.ToStringWithCulture(field.propertyName));
            this.Write("\", null);\r\n");
                  } 
            this.Write("                replacement.SetTextureOffset(\"");
            this.Write(this.ToStringHelper.ToStringWithCulture(field.propertyName));
            this.Write("\", new Vector2(");
            this.Write(this.ToStringHelper.ToStringWithCulture(field.offset.x.ToFloatString()));
            this.Write(", ");
            this.Write(this.ToStringHelper.ToStringWithCulture(field.offset.y.ToFloatString()));
            this.Write("));\r\n                replacement.SetTextureScale(\"");
            this.Write(this.ToStringHelper.ToStringWithCulture(field.propertyName));
            this.Write("\", new Vector2(");
            this.Write(this.ToStringHelper.ToStringWithCulture(field.tiling.x.ToFloatString()));
            this.Write(", ");
            this.Write(this.ToStringHelper.ToStringWithCulture(field.tiling.y.ToFloatString()));
            this.Write("));\r\n");
                  break;
                }
                case ShaderField.PropertyType.Vector: { 
            this.Write("                replacement.SetVector(\"");
            this.Write(this.ToStringHelper.ToStringWithCulture(field.propertyName));
            this.Write("\", new Vector4(");
            this.Write(this.ToStringHelper.ToStringWithCulture(field.vectorValue.x.ToFloatString()));
            this.Write(", ");
            this.Write(this.ToStringHelper.ToStringWithCulture(field.vectorValue.y.ToFloatString()));
            this.Write(", ");
            this.Write(this.ToStringHelper.ToStringWithCulture(field.vectorValue.z.ToFloatString()));
            this.Write(", ");
            this.Write(this.ToStringHelper.ToStringWithCulture(field.vectorValue.w.ToFloatString()));
            this.Write("));\r\n");
                  break;
                }
                case ShaderField.PropertyType.Color: { 
            this.Write("                replacement.SetColor(\"");
            this.Write(this.ToStringHelper.ToStringWithCulture(field.propertyName));
            this.Write("\", new Color(");
            this.Write(this.ToStringHelper.ToStringWithCulture(field.colorValue.r.ToFloatString()));
            this.Write(", ");
            this.Write(this.ToStringHelper.ToStringWithCulture(field.colorValue.g.ToFloatString()));
            this.Write(", ");
            this.Write(this.ToStringHelper.ToStringWithCulture(field.colorValue.b.ToFloatString()));
            this.Write(", ");
            this.Write(this.ToStringHelper.ToStringWithCulture(field.colorValue.a.ToFloatString()));
            this.Write("));\r\n");
                  break;
                }
                case ShaderField.PropertyType.Range:
                case ShaderField.PropertyType.Enum:
                case ShaderField.PropertyType.Float: { 
            this.Write("                replacement.SetFloat(\"");
            this.Write(this.ToStringHelper.ToStringWithCulture(field.propertyName));
            this.Write("\", ");
            this.Write(this.ToStringHelper.ToStringWithCulture(field.floatValue.ToFloatString()));
            this.Write(");\r\n");
                  break;
                }
                case ShaderField.PropertyType.Toggle: { 
            this.Write("                replacement.SetFloat(\"");
            this.Write(this.ToStringHelper.ToStringWithCulture(field.propertyName));
            this.Write("\", ");
            this.Write(this.ToStringHelper.ToStringWithCulture(field.floatValue.ToFloatString()));
            this.Write(");\r\n");
              if (field.floatValue != 0) { 
            this.Write("                replacement.EnableKeyword(\"");
            this.Write(this.ToStringHelper.ToStringWithCulture(field.keyword));
            this.Write("\");\r\n");
              } else { 
            this.Write("                replacement.DisableKeyword(\"");
            this.Write(this.ToStringHelper.ToStringWithCulture(field.keyword));
            this.Write("\");\r\n");
              } 
                  break;
                }
            } 
      } 
            this.Write("\r\n                return replacement;\r\n            }\r\n");
 } 
            this.Write("\r\n            private static IEnumerator HandleAsyncOperationProgress(LoadStaticC" +
                    "ontentAsyncArgs args, AsyncOperation operation, float startProgress, float endPr" +
                    "ogress)\r\n            {\r\n                args.ReportProgress(startProgress);\r\n   " +
                    "             yield return null;\r\n\r\n                while (!operation.isDone)\r\n  " +
                    "              {\r\n                    args.ReportProgress(Util.Remap(operation.pr" +
                    "ogress, 0, 1, startProgress, endProgress));\r\n                    yield return nu" +
                    "ll;\r\n                }\r\n                args.ReportProgress(endProgress);\r\n     " +
                    "       }\r\n\r\n            private static IEnumerator HandleAsyncOperationsProgress" +
                    "(LoadStaticContentAsyncArgs args, float startProgress, float endProgress, params" +
                    " IAsyncOperationWrapper[] operations)\r\n            {\r\n                args.Repor" +
                    "tProgress(startProgress);\r\n                yield return null;\r\n\r\n               " +
                    " bool allOperationsAreDone;\r\n                do\r\n                {\r\n            " +
                    "        allOperationsAreDone = true;\r\n                    var totalProgress = 0F" +
                    ";\r\n\r\n                    foreach (var operation in operations)\r\n                " +
                    "    {\r\n                        totalProgress += operation.Progress;\r\n           " +
                    "             allOperationsAreDone &= operation.IsDone;\r\n                    }\r\n\r" +
                    "\n                    args.ReportProgress(Util.Remap(totalProgress, 0, operations" +
                    ".Length, startProgress, endProgress));\r\n                    yield return null;\r\n" +
                    "                }\r\n                while (!allOperationsAreDone);\r\n\r\n           " +
                    "     args.ReportProgress(endProgress);\r\n            }\r\n\r\n            [MethodImpl" +
                    "(MethodImplOptions.AggressiveInlining)]\r\n            private static IAsyncOperat" +
                    "ionWrapper LoadAssetAsync<T>(AssetBundle assetBundle, string name)\r\n            " +
                    "{\r\n                return new AssetBundleAsyncOperationWrapper(assetBundle.LoadA" +
                    "ssetAsync<T>(name));\r\n            }\r\n\r\n            [MethodImpl(MethodImplOptions" +
                    ".AggressiveInlining)]\r\n            private static IAsyncOperationWrapper LoadAdd" +
                    "ressablesAssetAsync<T>(string name)\r\n            {\r\n                return new A" +
                    "ddressablesAsyncOperationWrapper<T>(Addressables.LoadAssetAsync<T>(name));\r\n    " +
                    "        }\r\n\r\n            private static void TryCatchThrow(string message, Actio" +
                    "n action)\r\n            {\r\n                try\r\n                {\r\n              " +
                    "      action?.Invoke();\r\n                }\r\n                catch (Exception e)\r" +
                    "\n                {\r\n                    throw new FieldException(message, e);\r\n " +
                    "               }\r\n            }\r\n\r\n            private class FieldException : Ex" +
                    "ception\r\n            {\r\n                public FieldException(string message, Ex" +
                    "ception innerException) : base(message, innerException) { }\r\n            }\r\n\r\n  " +
                    "          private interface IAsyncOperationWrapper\r\n            {\r\n             " +
                    "   bool IsDone { get; }\r\n                float Progress { get; }\r\n              " +
                    "  object Asset { get; }\r\n            }\r\n\r\n            private struct AssetBundle" +
                    "AsyncOperationWrapper : IAsyncOperationWrapper\r\n            {\r\n                p" +
                    "rivate readonly AsyncOperation operation;\r\n                public AssetBundleAsy" +
                    "ncOperationWrapper(AsyncOperation operation) => this.operation = operation;\r\n\r\n " +
                    "               public bool IsDone => operation.isDone;\r\n                public f" +
                    "loat Progress => operation.progress;\r\n                public object Asset => ope" +
                    "ration is AssetBundleRequest request ? request.asset : null;\r\n            }\r\n\r\n " +
                    "           private struct AddressablesAsyncOperationWrapper<T> : IAsyncOperation" +
                    "Wrapper\r\n            {\r\n                private readonly AsyncOperationHandle op" +
                    "eration;\r\n                public AddressablesAsyncOperationWrapper(AsyncOperatio" +
                    "nHandle operation) => this.operation = operation;\r\n\r\n                public bool" +
                    " IsDone => operation.IsDone;\r\n                public float Progress => operation" +
                    ".PercentComplete;\r\n                public object Asset => operation.Result;\r\n   " +
                    "         }\r\n        }\r\n    }\r\n}");
            return this.GenerationEnvironment.ToString();
        }
    }
}
